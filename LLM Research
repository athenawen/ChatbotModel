{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/athenawen/ChatbotModel/blob/main/LLM%20Research\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "fFMad_TrXM6H"
      },
      "source": [
        "# Intro to research, LLMs, and prompting - Algoverse AI Research\n",
        "\n",
        "#### **Please read all the instructions carefully! There's a lot of content here and a lot to learn.**\n",
        "\n",
        "In this notebook, you'll have the opportunity to **design and experiment with your own prompting functions**. Specifically, we have provided starter code to use Microsoft's Phi-1.5 language model on the GSM8K dataset. **Moreover, this code will be useful starter code for your research projects if you do something with LLMs, so make sure you understand it deeply.**\n",
        "\n",
        "Can you design any prompting techniques to improve LLM reasoning? Try out your ideas with the pipeline we provide - even if the approaches you think of seem minimalistic. We want you to gain confidence in formulating, experimenting, and testing your own ideas.\n",
        "\n",
        "Here's a [reference](https://www.promptingguide.ai/) for some types of prompting techniques that exist. Your ideas don't have to be extremely novel. A prompt technique could be as simple as appending the phrase \"let's think step by step\" at the end of the prompt (fun fact: this is actually known as the [zero-shot chain of thought prompt](https://arxiv.org/pdf/2205.11916).)"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "**You are welcome to try out different models and datasets if you'd like.** **If you have other ideas of things you'd like to try out, you are more than welcome to try them out.**"
      ],
      "metadata": {
        "id": "YITMhU5QGxUD"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "##### Legal Statement (You can ignore this if you're a student in our research program. Please don't share this Colab outside of this program.)"
      ],
      "metadata": {
        "id": "iJjMSoCxTLd1"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Copyright © 2023 Algoverse Coding Academy LLC. All rights reserved.\n",
        "\n",
        "This software and its contents are the property of Algoverse and are protected by copyright and other intellectual property laws. This software is licensed, not sold, and is available for use solely under the terms and conditions set forth in this license agreement.\n",
        "\n",
        "Unauthorized copying, modification, distribution, or use of this software, or any part thereof, is strictly prohibited and constitutes a violation of this license agreement and applicable laws.\n",
        "\n",
        "This software is provided for use only by authorized users in accordance with the terms and conditions of this agreement, and any use, reproduction, or distribution of this software not expressly authorized by this agreement is expressly prohibited.\n",
        "\n",
        "For inquiries regarding the use of this software or to obtain permissions beyond the scope of this license, please contact kevin@algoverseacademy.com.\n",
        "\n",
        "Any use of this software constitutes acceptance of these terms."
      ],
      "metadata": {
        "id": "KMRYLLyhUdsY"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Introduction to Colab\n",
        "\n",
        "#### What is this interface we're using? Here's a quick intro: https://colab.research.google.com/notebooks/intro.ipynb. I would spend 5-10 minutes on this. You can ignore the content about Gemini at the top."
      ],
      "metadata": {
        "id": "K-puBVf9chnB"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Important: You can't modify this file, you'll need to copy this file and use that version. In the file menu, \"File\" -> \"Save a copy in drive\".\n",
        "\n",
        "#### Also, you'll need to use GPU. In the file menu, \"runtime\" -> \"change runtime type\" -> \"T4 GPU\""
      ],
      "metadata": {
        "id": "i4c_MliIAhL7"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "For resources and questions on Pytorch, Colab, or anything else coding related, this should be your workflow, in order:\n",
        "\n",
        "1. **Ask ChatGPT / your favorite LLM for help.** You'll be surprised how effective it is at coding, even using complicated ML libraries.\n",
        "2. Try stack overflow and/or the official documentation of the given library you're using.\n",
        "3. **Ask questions on the discussion channel on our Slack**. This is the last line of defense, but if you can't find the answer above, please do not hesitate to ask any question, no matter how dumb you think it is or how minor of a detail you think it is.\n",
        "\n",
        "This Colab is very dense with content, but it is all very important to understand for the sake of being able to code your research projects if you're using LLMs. I recommend trying to lock in as much as possible (e.g remove distractions) and revisiting this Colab in multiple sittings if you'd like.\n",
        "\n",
        "One piece of advice for those of you who may be newer at coding and/or ML: **create new code cells to print your variables and try things out to get a \"feel\" for the code.**"
      ],
      "metadata": {
        "id": "KyQBadXYAyp1"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Installations"
      ],
      "metadata": {
        "id": "z32x6tofUjLf"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "First, we'll use pip to install some relevant libraries."
      ],
      "metadata": {
        "id": "SJ38mM0lUlqm"
      }
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "id": "F0WS1zFFcP_g",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "e6dfbe41-d85b-4cef-f82f-fb145ed4d324"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Collecting datasets\n",
            "  Downloading datasets-3.2.0-py3-none-any.whl.metadata (20 kB)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from datasets) (3.16.1)\n",
            "Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.26.4)\n",
            "Requirement already satisfied: pyarrow>=15.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (17.0.0)\n",
            "Collecting dill<0.3.9,>=0.3.0 (from datasets)\n",
            "  Downloading dill-0.3.8-py3-none-any.whl.metadata (10 kB)\n",
            "Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (2.2.2)\n",
            "Requirement already satisfied: requests>=2.32.2 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.32.3)\n",
            "Requirement already satisfied: tqdm>=4.66.3 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.67.1)\n",
            "Collecting xxhash (from datasets)\n",
            "  Downloading xxhash-3.5.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)\n",
            "Collecting multiprocess<0.70.17 (from datasets)\n",
            "  Downloading multiprocess-0.70.16-py310-none-any.whl.metadata (7.2 kB)\n",
            "Collecting fsspec<=2024.9.0,>=2023.1.0 (from fsspec[http]<=2024.9.0,>=2023.1.0->datasets)\n",
            "  Downloading fsspec-2024.9.0-py3-none-any.whl.metadata (11 kB)\n",
            "Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.11.10)\n",
            "Requirement already satisfied: huggingface-hub>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.27.0)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (24.2)\n",
            "Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0.2)\n",
            "Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.4.4)\n",
            "Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.2)\n",
            "Requirement already satisfied: async-timeout<6.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (4.0.3)\n",
            "Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (24.3.0)\n",
            "Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.5.0)\n",
            "Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (6.1.0)\n",
            "Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (0.2.1)\n",
            "Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.18.3)\n",
            "Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.23.0->datasets) (4.12.2)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (3.4.0)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (2.2.3)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (2024.12.14)\n",
            "Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2024.2)\n",
            "Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2024.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.17.0)\n",
            "Downloading datasets-3.2.0-py3-none-any.whl (480 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m480.6/480.6 kB\u001b[0m \u001b[31m14.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading dill-0.3.8-py3-none-any.whl (116 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m116.3/116.3 kB\u001b[0m \u001b[31m4.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading fsspec-2024.9.0-py3-none-any.whl (179 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m179.3/179.3 kB\u001b[0m \u001b[31m644.0 kB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading multiprocess-0.70.16-py310-none-any.whl (134 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m11.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading xxhash-3.5.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (194 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.1/194.1 kB\u001b[0m \u001b[31m18.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: xxhash, fsspec, dill, multiprocess, datasets\n",
            "  Attempting uninstall: fsspec\n",
            "    Found existing installation: fsspec 2024.10.0\n",
            "    Uninstalling fsspec-2024.10.0:\n",
            "      Successfully uninstalled fsspec-2024.10.0\n",
            "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "gcsfs 2024.10.0 requires fsspec==2024.10.0, but you have fsspec 2024.9.0 which is incompatible.\u001b[0m\u001b[31m\n",
            "\u001b[0mSuccessfully installed datasets-3.2.0 dill-0.3.8 fsspec-2024.9.0 multiprocess-0.70.16 xxhash-3.5.0\n",
            "Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.47.1)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.16.1)\n",
            "Requirement already satisfied: huggingface-hub<1.0,>=0.24.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.27.0)\n",
            "Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.26.4)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (24.2)\n",
            "Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0.2)\n",
            "Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2024.11.6)\n",
            "Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.32.3)\n",
            "Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.21.0)\n",
            "Requirement already satisfied: safetensors>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.4.5)\n",
            "Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.67.1)\n",
            "Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.24.0->transformers) (2024.9.0)\n",
            "Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.24.0->transformers) (4.12.2)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4.0)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.2.3)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2024.12.14)\n",
            "Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.47.1)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.16.1)\n",
            "Requirement already satisfied: huggingface-hub<1.0,>=0.24.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.27.0)\n",
            "Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.26.4)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (24.2)\n",
            "Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0.2)\n",
            "Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2024.11.6)\n",
            "Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.32.3)\n",
            "Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.21.0)\n",
            "Requirement already satisfied: safetensors>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.4.5)\n",
            "Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.67.1)\n",
            "Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.24.0->transformers) (2024.9.0)\n",
            "Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.24.0->transformers) (4.12.2)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4.0)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.2.3)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2024.12.14)\n",
            "Requirement already satisfied: einops in /usr/local/lib/python3.10/dist-packages (0.8.0)\n"
          ]
        }
      ],
      "source": [
        "!pip install datasets\n",
        "!pip install transformers\n",
        "!pip install --upgrade transformers\n",
        "!pip install einops"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# Dataset"
      ],
      "metadata": {
        "id": "hHzPM0vsyWkU"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "kEPjclPzLJQb"
      },
      "source": [
        "## Downloading GSM8K\n",
        "\n",
        "First, we download GSM8K from Huggingface, the gold standard platform containing ML datasets and models. This is where you'll find most of the models and datasets you'll use in your research. The code here can largely be reused for the datasets that you'll download in your own research.\n",
        "\n",
        "A summary of GSM8K from their official repo: State-of-the-art language models can match human performance on many tasks, but they still struggle to robustly perform multi-step mathematical reasoning. To diagnose the failures of current models and support research, we're releasing GSM8K, a **dataset of 8.5K high quality linguistically diverse grade school math word problems**. We find that even the largest transformer models fail to achieve high test performance, despite the conceptual simplicity of this problem distribution.\n",
        "\n",
        "** As of late 2023, the last sentence isn't quite true anymore. Using GPT4 with prompting, self consistency, and tool-use (e.g prompting the LLM to output Python code and then connecting it to a code interpreter that can execute the code), we can achieve above 95% accuracy: [source](https://paperswithcode.com/sota/arithmetic-reasoning-on-gsm8k).\n",
        "\n",
        "For more information about GSM8K, please refer to the following resources:\n",
        "- OpenAI blogpost: https://openai.com/research/solving-math-word-problems\n",
        "- GSM8K Github repository: https://github.com/openai/grade-school-math#calculation-annotations\n",
        "- Huggingface dataset: https://huggingface.co/datasets/gsm8k\n",
        "- GSM8K Paper: https://arxiv.org/abs/2110.14168\n",
        "\n",
        "We recommend reading the OpenAI blogpost, the GSM8K Github repository README, and the Huggingface page. You can also read the paper if you have time.\n",
        "\n",
        "For our use case here, you may ignore the distinction between train and test datasets, since we're not training any models on this data."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "id": "Q8gFg9nGdB2g"
      },
      "outputs": [],
      "source": [
        "from datasets import load_dataset\n",
        "import json"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "metadata": {
        "id": "jU6jssO8dHug",
        "collapsed": true,
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 304,
          "referenced_widgets": [
            "390f3e1b4ac64c4ab7f1002ff8aae546",
            "f1e91c56f1cb4e139f7b701c1b0e4554",
            "918e7530e37340779d14e96e813789ec",
            "aac2ca4181c9416e95a819997e9a87d7",
            "e1b888e1e2ba46a7afd4ebdc67a7253e",
            "cfe5fc58171d4ba5b552cb9e4b2b719f",
            "247c6ba72700455599e617e49e970879",
            "99b6582b66b84030af76e91a2c95eda7",
            "d5d0199919d64998a50d4b224cd8fb50",
            "6938dd8af2ee4c649ca52f6c14df1b75",
            "7d1358b3f52c4f5ca28565e4be1790ef",
            "2f7fae69adc64eae84ac0e37f2263cac",
            "e49bbdbcb703454590522b37648d8be1",
            "c6091b42cd9f40c783ee6f0102ef5428",
            "28d436bb6f294ae0a636a07b7276a27d",
            "f55bbd0385644606a0f503196b84a28e",
            "7055bc9c1fac422e88c195931bd1a08e",
            "29e400910f6d4d6ca83c76526d7ca54d",
            "c736de1966d6405d9f8644a591712ccd",
            "88854c254940440d96d24618c8d30b71",
            "ae060401db7b40b388b7ace9fddb02da",
            "53eb28eefae047c486a771079ab3ff74",
            "80128482cc454833980f9a1285ad2ce0",
            "b26d1d5a12204b749a7fd85f4f721dfd",
            "34bf18ba47cf4a20bae1bca4098943be",
            "6ffecb1bd34546e5b697c4836943aaf9",
            "b862a82209c348c0ba026a3df6befe26",
            "aa14cc2094b04df8a93caa0648231a44",
            "d7271005f91a49e19c48de1d9d201e9b",
            "56f6981432cc4cf698dae1f7005bdce4",
            "0462bfb6efa04595aedf4acd39195dce",
            "9a69787f300942388d606ce3bf85f41e",
            "c0497b46f47f449393028e6aa7fe160d",
            "0e3f83faa62f48acbfac2215aa456816",
            "cf2296bc0ed54616b6407094a7c5639c",
            "44b18ef367494e00adb545e45e8474ac",
            "959dfcdac96542819f91f2001940ff83",
            "055115bdcf8541f181cd1af98787d272",
            "76b1556ccafe42debcd7d4070adf1328",
            "6b406864f7c84d33bcc1527a71906a1a",
            "a2a8dff5b3fc4909ad97eb6dcb9efc93",
            "3c69ec5f3c4c44938bab05ae740575fd",
            "568f24ebf4c04a4989e3f8be66496838",
            "750305af96324dbc84c688ee208d83c9",
            "63ab9226d7ce4e7aba1f39d58f6cc861",
            "3091c2b99cd9451898f1a8ef2ee19d6a",
            "83af47ff285c46d9bfc37dd2b595ed47",
            "6a796acbc67c40daad79a23f39c88670",
            "671d34f188184f3eac4b385d01214a3a",
            "02cadd6986124517b9c670db3ad70bd8",
            "54b3a839ca7941caa955a42671919b94",
            "78281c1e15be448ebb491fc0880b87a9",
            "2d4dee2313c249bda9a32e96382168ab",
            "f34944d03fd04a138ce88afd18452d58",
            "8c0543e35d4a46f49b948356d0607d16"
          ]
        },
        "outputId": "9406a88d-71bd-4d33-ffed-eaa903c5a318"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: \n",
            "The secret `HF_TOKEN` does not exist in your Colab secrets.\n",
            "To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n",
            "You will be able to reuse this secret in all of your notebooks.\n",
            "Please note that authentication is recommended but still optional to access public models or datasets.\n",
            "  warnings.warn(\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "README.md:   0%|          | 0.00/7.94k [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "390f3e1b4ac64c4ab7f1002ff8aae546"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "train-00000-of-00001.parquet:   0%|          | 0.00/2.31M [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "2f7fae69adc64eae84ac0e37f2263cac"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "test-00000-of-00001.parquet:   0%|          | 0.00/419k [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "80128482cc454833980f9a1285ad2ce0"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Generating train split:   0%|          | 0/7473 [00:00<?, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "0e3f83faa62f48acbfac2215aa456816"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Generating test split:   0%|          | 0/1319 [00:00<?, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "63ab9226d7ce4e7aba1f39d58f6cc861"
            }
          },
          "metadata": {}
        }
      ],
      "source": [
        "train_dataset = load_dataset(\"gsm8k\", \"main\", split=\"train\")\n",
        "test_dataset = load_dataset(\"gsm8k\", \"main\", split=\"test\")\n",
        "\n",
        "# Creating a \"debug\" dataset for faster iteration\n",
        "debug_dataset = train_dataset.select(range(0, 5))  # Select the first 5 for debug set"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "id": "oQ2UKGbTjb2R",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 113,
          "referenced_widgets": [
            "6fe7b8a5ad674d11acd3bf7c720bcd54",
            "40e43dc6978340e8aa562f2cc77340de",
            "7b5f1f77c3194921bfad9c679464610a",
            "643146741aae4ec88ddfffbf70a06069",
            "c444287ed4e541d69ba588731e653794",
            "a3c7c080dbaf4d4d99f0feff29179c0c",
            "623daa9ee6794901b97a3a4a31b244a9",
            "d7cac953d6234acb8abcb8eb45561e0f",
            "5a1134fb3fa444299797c22ee00d2bab",
            "2a62c3460a4c47aabf6aafe00d9a72f0",
            "cf7c90a457f84fa9a3180e934beceda4",
            "3bda77ec9ec94a1b97dd8eb25d39600e",
            "b982557685424ae78ab7f34a7a6b47c8",
            "1827df2ce95346b1a0c1e8ba9b7fe6a5",
            "2dfb65dad23649eab651d2634621822d",
            "2e5144b505594707a9fe0a593bdc58c7",
            "f44976d20a12446a8740ab5d540d2ac3",
            "49c56998ed494cc2b75cb4da6f2ab378",
            "3f9ad5154be343d5bbe92219644fd90a",
            "9bd3ec8bc8c64ea1ac62511fc8ce9dad",
            "8bd733aed0264eb6bdaa0d56cdfeb4c9",
            "9895e8ec98524096aac923b8326b1356",
            "af85b521821e40ea98629b1e557ec20a",
            "9f0b8329fea8459ca35869e092186d51",
            "b3977c26e2cf47a6a2846f03d93a6b2a",
            "e19c59d7898e4a4487e4ab1916eed372",
            "34fd3ee511f04cba9117eda66c203292",
            "8d4aef19420148bc80b432fba2af425b",
            "af3f33e680ca43cba5a9252d3129ca10",
            "ec3fd671152247b19732960e43149106",
            "4b23cbb285dc48529052850e212ad60c",
            "cac1c02cca3947c1974ea98c1baeba51",
            "7757d6ef63194c4ab96d1ca4f8f644d8"
          ]
        },
        "outputId": "364ceacc-0af2-4b5b-b337-c00f9c8cfe77"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Map:   0%|          | 0/7473 [00:00<?, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "6fe7b8a5ad674d11acd3bf7c720bcd54"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Map:   0%|          | 0/5 [00:00<?, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "3bda77ec9ec94a1b97dd8eb25d39600e"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Map:   0%|          | 0/1319 [00:00<?, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "af85b521821e40ea98629b1e557ec20a"
            }
          },
          "metadata": {}
        }
      ],
      "source": [
        "# GSM8K answers are annotated with \"<<\" and \">>\" for a certain reason - a quick check to see if you have comprehended the resources above on GSM8K would be to check verify the reason why the authors did this. In any case, we'll be removing them.\n",
        "\n",
        "def clean_data(text):\n",
        "    return text.replace(\"<<\", \"\").replace(\">>\", \"\")\n",
        "\n",
        "train_dataset = train_dataset.map(lambda x: {\"answer\": clean_data(x[\"answer\"])})\n",
        "debug_dataset = debug_dataset.map(lambda x: {\"answer\": clean_data(x[\"answer\"])})\n",
        "test_dataset = test_dataset.map(lambda x: {\"answer\": clean_data(x[\"answer\"])})"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "id": "g0qMRKGUjtm3",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "1b1049cb-e43e-41c2-8133-c4388cc900a9"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "{'question': 'Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?',\n",
              " 'answer': 'Natalia sold 48/2 = 48/2=2424 clips in May.\\nNatalia sold 48+24 = 48+24=7272 clips altogether in April and May.\\n#### 72'}"
            ]
          },
          "metadata": {},
          "execution_count": 5
        }
      ],
      "source": [
        "# After cleaning, let's take a look at the first question/answer. Note that in Colab, the last line gets displayed, so you don't need to wrap this in a print statement.\n",
        "\n",
        "train_dataset[0]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "id": "ocYZROxzj67x",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "ad27e04d-e742-4341-aa6e-2c9a2b0c855c"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "{'question': 'Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?',\n",
              " 'answer': 'Natalia sold 48/2 = 48/2=2424 clips in May.\\nNatalia sold 48+24 = 48+24=7272 clips altogether in April and May.\\n#### 72'}"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ],
      "source": [
        "debug_dataset[0]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "metadata": {
        "id": "vRfuB8Z5joGJ"
      },
      "outputs": [],
      "source": [
        "# Converting to Pytorch. What is a Pytorch dataloader? Ask ChatGPT/another LLM.\n",
        "\n",
        "from torch.utils.data import DataLoader\n",
        "\n",
        "train_dataloader = DataLoader(train_dataset, batch_size=1, shuffle=False)\n",
        "test_dataloader = DataLoader(test_dataset, batch_size=1, shuffle=False)\n",
        "debug_dataloader = DataLoader(debug_dataset, batch_size=1, shuffle=False)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "id": "Z70J9usHmTcr",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "47e62476-4248-47a0-9a3d-a4f12f222a90"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Type of train_dataset: <class 'datasets.arrow_dataset.Dataset'>\n",
            "Type of train_loader: <class 'torch.utils.data.dataloader.DataLoader'>\n"
          ]
        }
      ],
      "source": [
        "# Note the types of the data we are working with. This should guide your development process.\n",
        "\n",
        "print(\"Type of train_dataset:\", type(train_dataset))\n",
        "print(\"Type of train_loader:\", type(train_dataloader))"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Get a feel of your data. This cell just outputs some sample datapoints.\n",
        "\n",
        "for batch in debug_dataloader:\n",
        "  question = batch['question']\n",
        "  print(question)\n",
        "\n",
        "# Quick check - how would you print each answer for the above questions?"
      ],
      "metadata": {
        "id": "q5icZyz-Pwmd",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "5bcf2d22-70d6-433a-cc0b-b50dadd4557c"
      },
      "execution_count": 9,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "['Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?']\n",
            "['Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?']\n",
            "['Betty is saving money for a new wallet which costs $100. Betty has only half of the money she needs. Her parents decided to give her $15 for that purpose, and her grandparents twice as much as her parents. How much more money does Betty need to buy the wallet?']\n",
            "['Julie is reading a 120-page book. Yesterday, she was able to read 12 pages and today, she read twice as many pages as yesterday. If she wants to read half of the remaining pages tomorrow, how many pages should she read?']\n",
            "['James writes a 3-page letter to 2 different friends twice a week.  How many pages does he write a year?']\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# Model"
      ],
      "metadata": {
        "id": "bzMs1-yvycV-"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "zVZkhcmToXWR"
      },
      "source": [
        "## Downloading Phi1.5B\n",
        "\n",
        "Here, we download and set-up our model from Huggingface. To start, here's Microsoft's Phi-1.5b, a small model that was trained on textbooks. For more information about Phi-1.5b, please refer to the following resources:\n",
        "\n",
        "- Huggingface link: https://huggingface.co/microsoft/phi-1_5\n",
        "- Phi-1.5b paper: https://arxiv.org/pdf/2309.05463.pdf (no need to read this  paper, but feel free to skim/read it if you're interested)\n",
        "\n",
        "Phi-1.5b has some data contamination problems with GSM8K, which is probably why it scores so well (relatively speaking), but that means it’s suitable for our purposes as a test model anyway.\n",
        "\n",
        "This code can also largely be reused for your research projects."
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Verifying which version of transformers we're on. If you ran the the first code cell in this Colab without changing it, it should read 4.37.2. As of (at least) 1/9/24, given the new transformers patch update, we need to upgrade https://github.com/huggingface/transformers/pull/26170#issuecomment-1868554410.\n",
        "\n",
        "# !pip list | grep transformers"
      ],
      "metadata": {
        "id": "8BpY4tLLMH1o"
      },
      "execution_count": 10,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "MEcpKvU1eBEX",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 151,
          "referenced_widgets": [
            "364bd0f06bda4b74addc4c08bf301d20",
            "f83140ce1dd1468ea25636605d813063",
            "7e2624d0e60c471086adfff7e23a8e29",
            "23c84439b65d449e8681e5d00a7a3504",
            "f51ff6773e5e40f7a9a974785885938d",
            "03a0776b46e441fe8a98c258bc9966aa",
            "b9e1e2f206844db48e0c743721c862b2",
            "98495e76add04feaa3a46f09b0dbb8ff",
            "7bff001815f8437785ddd4acc11f8b75",
            "78a073afa98d4a11941b2c20b01e49a4",
            "78a48fa552664d21a5fecff00ad2ee9d",
            "39c4f067b9ed40328b95942be3069e3f",
            "e179aca2b3aa46959473e535ce9748e5",
            "2d48cb2813964aa4a3efaefc658cc437",
            "344bb7559f104bfabf70b778561ec16c",
            "acd17af546174af381f846279dd52373",
            "8189d087aabd4747976cba69bc9db163",
            "3ab11073819140ae865d16747bb72ec5",
            "554e6305f42343e6bc02d6d5c3ccb955",
            "ea69cc07f7654a08bbdeb8e862222f0b",
            "ebb2c319dba145d68fce044b4ee4d10f",
            "1209e8d59c03431b861853979a3f3926",
            "b84ee7d9b4c042ffbab58723ca42447b",
            "8aba93befc44408f84882ed782f34f68",
            "6be4cd71fa284738976c62afc1f67694",
            "19b33d63ba73475aafec1b3c397ae3a3",
            "2066be09ba96465b9d5b4a33ea86cf94",
            "bf783c5568bf4a5b84110a89db327c84",
            "814f604387664b6eae3e9cc51f1d8759",
            "0bf0e7d68faf4539886038154f6b6799",
            "d6e1cf1a545349f5b7c7860f1eefbb04",
            "28f4af2c798a43a69a4fd29c2f02125f",
            "2dc31f2b60144b27ace066a8b2560ef8"
          ]
        },
        "outputId": "4189f755-b9ef-4bc2-8b69-9c9ea4121635"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "The cache for model files in Transformers v4.22.0 has been updated. Migrating your old cache. This is a one-time only operation. You can interrupt this and resume the migration later on by calling `transformers.utils.move_cache()`.\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "0it [00:00, ?it/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "364bd0f06bda4b74addc4c08bf301d20"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "config.json:   0%|          | 0.00/736 [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "39c4f067b9ed40328b95942be3069e3f"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "model.safetensors:   0%|          | 0.00/2.84G [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "b84ee7d9b4c042ffbab58723ca42447b"
            }
          },
          "metadata": {}
        }
      ],
      "source": [
        "import torch\n",
        "from transformers import AutoModelForCausalLM, AutoTokenizer\n",
        "\n",
        "# Set default device to CUDA (i.e GPU)\n",
        "torch.set_default_device(\"cuda\")\n",
        "\n",
        "# Load the model and the corresponding tokenizer\n",
        "model = AutoModelForCausalLM.from_pretrained(\"microsoft/phi-1_5\", torch_dtype=\"auto\", trust_remote_code=True)\n",
        "tokenizer = AutoTokenizer.from_pretrained(\"microsoft/phi-1_5\", trust_remote_code=True)"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Trying out the model\n",
        "\n",
        "First, we tokenize the input using `tokenizer`. Then we get the output with `model.generate`."
      ],
      "metadata": {
        "id": "9IN4l1KSPGJH"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "question, true_answer = debug_dataloader.dataset[0]['question'], debug_dataloader.dataset[0]['answer']\n",
        "\n",
        "print(\"Question: \", question)\n",
        "\n",
        "inputs = tokenizer(question, return_tensors=\"pt\")\n",
        "inputs = inputs.to(\"cuda\")\n",
        "\n",
        "# Read up on what max_new_tokens and do_sample do! These are two very important parameters.\n",
        "outputs = model.generate(**inputs, max_new_tokens=200, do_sample=False)\n",
        "\n",
        "output_answer = tokenizer.batch_decode(outputs, skip_special_tokens=True)[0]\n",
        "print(f\"Raw output answer: {output_answer}\")"
      ],
      "metadata": {
        "id": "myUt0zSOPEZF"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "Interpretation of the output:\n",
        "\n",
        "1. Note that `output_answer` first starts with the question at hand. This is due to the autoregressive nature of LLMs. The first tokens that are generated are the input tokens.\n",
        "\n",
        "2. Note that Phi can produce Python code, which is what it did in this case.\n",
        "\n",
        "3. Note that since Phi1.5 is a small model that has not been \"instruction tuned\" (i.e it hasn't been fine-tuned to follow instructions), it will produce gibberish after it finishes producing its intended output. In this case the intended output ended with the line `print(result)`, and everything after that (i.e `Student: a company has ...` onwards)  is gibberish.\n",
        "\n",
        "     -- Sidenote conceptual check - LLMs can produce different results for the same prompt, depending on the settings of the model. Based on the code, how did I know that the output that you received would be exactly that?\n",
        "\n",
        "**Thus, we'll have to write some code later to extract the intended answer from its output, removing the gibberish.** You'll have to do this for other models that haven't been instruction tuned that you use for your research, such as Mistral models, Llama models, or GPT3 (not GPT3.5, which is instruction fine-tuned.). We'll also need some code to extract the numerical answer from the intended output, regardless if it's instruction tuned or not.\n",
        "\n",
        "This is often a fairly annoying task that you need to use [regex](https://www.w3schools.com/python/python_regex.asp) to solve based on pattern matching, and the code you need to write often varies based on the model and dataset you use, so you'll need to create different versions of the code accordingly. Also there are sometimes many types of cases to consider since the model doesn't always follow a rigid pattern. Fortunately though, few shot prompting helps us get the output in a more consistent pattern.\n",
        "\n",
        "More on this, two sections from now."
      ],
      "metadata": {
        "id": "NPFNfUeIZ0wI"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Feel free to try out what Phi outputs for other questions by copying and slightly changing the above code."
      ],
      "metadata": {
        "id": "HnRITGM-jvd5"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Your code here"
      ],
      "metadata": {
        "id": "d7eKysSfjtD2"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Few shot prompting with Chain of Thought"
      ],
      "metadata": {
        "id": "BoWt5A-vdVqA"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's see how Phi does if we prepend the chain of thought prompt in front of the question at hand.\n",
        "\n",
        "Recall that few-shot prompting means to provide some examples for the model to pattern match with. Here's the 8-shot prompt from pg. 43 in the CoT paper, which is the standard that researchers use when benchmarking with CoT, such as using it as a baseline to compare their method with.\n",
        "\n",
        "Also for comparison, here's the same few shot prompt but without the chain of thought."
      ],
      "metadata": {
        "id": "nBSDwHx3hFhl"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "VswpDSWUxPvb"
      },
      "outputs": [],
      "source": [
        "chain_of_thought_prompt = \"\"\"Q: There are 15 trees in the grove. Grove workers will plant trees in the grove today. After they are done, there\n",
        "will be 21 trees. How many trees did the grove workers plant today?\n",
        "A: We start with 15 trees. Later we have 21 trees. The difference must be the number of trees they planted. So,\n",
        "they must have planted 21 - 15 = 6 trees. The answer is 6.\n",
        "Q: If there are 3 cars in the parking lot and 2 more cars arrive, how many cars are in the parking lot?\n",
        "A: There are 3 cars in the parking lot already. 2 more arrive. Now there are 3 + 2 = 5 cars. The answer is 5.\n",
        "Q: Leah had 32 chocolates and her sister had 42. If they ate 35, how many pieces do they have left in total?\n",
        "A: Leah had 32 chocolates and Leah’s sister had 42. That means there were originally 32 + 42 = 74 chocolates.\n",
        "35 have been eaten. So in total they still have 74 - 35 = 39 chocolates. The answer is 39.\n",
        "Q: Jason had 20 lollipops. He gave Denny some lollipops. Now Jason has 12 lollipops. How many lollipops did\n",
        "Jason give to Denny?\n",
        "A: Jason had 20 lollipops. Since he only has 12 now, he must have given the rest to Denny. The number of\n",
        "lollipops he has given to Denny must have been 20 - 12 = 8 lollipops. The answer is 8.\n",
        "Q: Shawn has five toys. For Christmas, he got two toys each from his mom and dad. How many toys does he\n",
        "have now?\n",
        "A: He has 5 toys. He got 2 from mom, so after that he has 5 + 2 = 7 toys. Then he got 2 more from dad, so in\n",
        "total he has 7 + 2 = 9 toys. The answer is 9.\n",
        "Q: There were nine computers in the server room. Five more computers were installed each day, from monday\n",
        "to thursday. How many computers are now in the server room?\n",
        "A: There are 4 days from monday to thursday. 5 computers were added each day. That means in total 4 * 5 = 20\n",
        "computers were added. There were 9 computers in the beginning, so now there are 9 + 20 = 29 computers. The\n",
        "answer is 29.\n",
        "Q: Michael had 58 golf balls. On tuesday, he lost 23 golf balls. On wednesday, he lost 2 more. How many golf\n",
        "balls did he have at the end of wednesday?\n",
        "A: Michael initially had 58 balls. He lost 23 on Tuesday, so after that he has 58 - 23 = 35 balls. On Wednesday\n",
        "he lost 2 more so now he has 35 - 2 = 33 balls. The answer is 33.\n",
        "Q: Olivia has $23. She bought five bagels for $3 each. How much money does she have left?\n",
        "A: She bought 5 bagels for $3 each. This means she spent 5 * $3 = $15 on the bagels. She had $23 in beginning,\n",
        "so now she has $23 - $15 = $8. The answer is 8\"\"\" # 8-shot prompt from pg. 43 in the CoT paper\n",
        "\n",
        "non_chain_of_thought_prompt = \"\"\"Q: There are 15 trees in the grove. Grove workers will plant trees in the grove today. After they are done, there\n",
        "will be 21 trees. How many trees did the grove workers plant today?\n",
        "A: The answer is 6.\n",
        "Q: If there are 3 cars in the parking lot and 2 more cars arrive, how many cars are in the parking lot?\n",
        "A: The answer is 5.\n",
        "Q: Leah had 32 chocolates and her sister had 42. If they ate 35, how many pieces do they have left in total?\n",
        "A: The answer is 39.\n",
        "Q: Jason had 20 lollipops. He gave Denny some lollipops. Now Jason has 12 lollipops. How many lollipops did\n",
        "Jason give to Denny?\n",
        "A: The answer is 8.\n",
        "Q: Shawn has five toys. For Christmas, he got two toys each from his mom and dad. How many toys does he\n",
        "have now?\n",
        "A: The answer is 9.\n",
        "Q: There were nine computers in the server room. Five more computers were installed each day, from monday\n",
        "to thursday. How many computers are now in the server room?\n",
        "A: The answer is 29.\n",
        "Q: Michael had 58 golf balls. On tuesday, he lost 23 golf balls. On wednesday, he lost 2 more. How many golf\n",
        "balls did he have at the end of wednesday?\n",
        "A: The answer is 33.\n",
        "Q: Olivia has $23. She bought five bagels for $3 each. How much money does she have left?\n",
        "A: The answer is 8\"\"\"\n",
        "\n",
        "debug_prompt = \"this is a debugging prompt\" # for easier visibility when debugging"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Here's a function that just prepends the CoT prompt to the question."
      ],
      "metadata": {
        "id": "2LB2itLOhpEf"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "M_4obnuQpOao"
      },
      "outputs": [],
      "source": [
        "def cot_prompt_function(question):\n",
        "  return chain_of_thought_prompt + \"\\n\" + \"Q: \" + question\n",
        "\n",
        "def non_cot_prompt_function(question):\n",
        "  return non_chain_of_thought_prompt + \"\\n\" + \"Q: \" + question\n",
        "\n",
        "# Later, revisit this cell and define your own prompt functions here. The two functions above happen to simply prepend a prompt to the question, but you're welcome to try out more advanced prompt functions!"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's try the question from above, but now with chain of thought."
      ],
      "metadata": {
        "id": "d4fDC1i0iaUn"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "question, true_answer = debug_dataloader.dataset[0]['question'], debug_dataloader.dataset[0]['answer']\n",
        "\n",
        "print(\"Question: \", question)\n",
        "\n",
        "question_with_prompt = cot_prompt_function(question)\n",
        "# print(question_with_prompt)\n",
        "\n",
        "inputs = tokenizer(question_with_prompt, return_tensors=\"pt\")\n",
        "inputs = inputs.to(\"cuda\")\n",
        "\n",
        "# Read up on what max_new_tokens and do_sample do! These are two very important parameters.\n",
        "outputs = model.generate(**inputs, max_new_tokens=200, do_sample=False)\n",
        "\n",
        "output_answer = tokenizer.batch_decode(outputs, skip_special_tokens=True)[0]\n",
        "print(f\"Raw output answer: {output_answer}\")"
      ],
      "metadata": {
        "id": "F8lpHsb-iFBS"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "Interpretation of above:\n",
        "\n",
        "1. Remember again, due to autoregression, the output_answer first contains the input tokens, which now contains the 8 shot CoT prompt.\n",
        "\n",
        "2. Remember again that this model produces gibberish after it finishes its intended answer.\n",
        "\n",
        "3. The answer it produces is more chain of thought-y:\n",
        "\n",
        "```\n",
        "# A: Natalia sold 48 clips in April. In May, she sold half as many, so she sold 48 / 2 = 24 clips. Altogether, she sold 48 + 24 = 72 clips. The answer is 72.\n",
        "\n",
        "```"
      ],
      "metadata": {
        "id": "2TqHwa0RigMx"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Try running non CoT as well. You should see that the CoT prompt results in the model generating CoT as well, while the non-CoT prompt results in the model generating strictly the answers without CoT. You should be able to see that CoT does better!"
      ],
      "metadata": {
        "id": "Jia4VYjfjeDu"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Your code here"
      ],
      "metadata": {
        "id": "yA1swaVmjmeo"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Extraction"
      ],
      "metadata": {
        "id": "2rUDeH0DkvJh"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Here's some code to extract our intended answer. We won't explain in as much detail as the above tutorials how this works - try understanding it all yourself. Use ChatGPT to help you out!\n",
        "\n",
        "`extract_intended_generation` extracts the intended generation from the gibberish at the end.\n",
        "\n",
        "`extract_output_numerical_answer` extracts the numerical answer from the intended generation.\n",
        "\n",
        "`extract_true_numerical_answer` is unrelated to the generations. This extracts the numerical answer from the ground truth answer in the GSM8K dataset answer text.\n",
        "\n",
        "When you define your own prompting functions, you'll likely need to create variations of `extract_last_answer` and `extract_output_numerical_answer` to make it work for your case."
      ],
      "metadata": {
        "id": "GfxXGA8Nk1zC"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "from torch.utils.data import DataLoader\n",
        "import re\n",
        "\n",
        "\n",
        "# Note - there are probably better ways to do this than what is shown here. This is just for illustration, as a simple way to extract the intended generation.\n",
        "def extract_intended_generation(full_text): # You will most likely need to create variations of this method to extract your intended answer, depending on the output of your prompt.\n",
        "    try:\n",
        "      # The output includes the prompt as well. Split the text into segments based on 'A: ' which starts each answer\n",
        "      segments = full_text.split('A: ')\n",
        "\n",
        "      # Take the last segment, which should be the most recent answer\n",
        "      last_answer = segments[-1].strip()\n",
        "\n",
        "      # For some reason, the outputted answer includes part of 'Question 1' afterwards. This code splits the output before that occurs\n",
        "      last_answer = last_answer.split(\"Question 1:\")[0].strip()\n",
        "\n",
        "      return last_answer\n",
        "\n",
        "    except ValueError as e:\n",
        "      return None\n",
        "\n",
        "\n",
        "\n",
        "def extract_output_numerical_answer(text, key_phrase=\"The answer is\"): # You will most likely need to create variations of this function to extract your intended numerical answer, depending on the output of your prompt.\n",
        "    if text is None:\n",
        "        return None\n",
        "\n",
        "    try:\n",
        "        # Find the position where 'The answer is' starts in the text\n",
        "        start_pos = text.index(key_phrase) + len(key_phrase)\n",
        "\n",
        "        # Extract the text that comes after 'The answer is'\n",
        "        answer_text = text[start_pos:].strip()\n",
        "\n",
        "        # Use a regular expression to find a floating point or integer number\n",
        "        matches = re.findall(r'[-+]?\\d*\\.\\d+|\\d+', answer_text)\n",
        "\n",
        "        if matches:\n",
        "            return float(matches[0])\n",
        "        else:\n",
        "            return None\n",
        "\n",
        "    except ValueError:\n",
        "        return None\n",
        "\n",
        "\n",
        "def extract_true_numerical_answer(text):\n",
        "    # Find the position of the \"#### \" pattern in the text\n",
        "    position = text.find(\"#### \")\n",
        "\n",
        "    # Extract the numerical part that follows this pattern\n",
        "    if position != -1:\n",
        "        numerical_str = text[position + 5:].strip()\n",
        "        try:\n",
        "            return float(numerical_str)\n",
        "        except ValueError:\n",
        "            print(f\"Error: Could not convert '{numerical_str}' to float.\")\n",
        "            return None\n",
        "    else:\n",
        "        return None  # or some error handling"
      ],
      "metadata": {
        "id": "cKR8p7P2k0s5"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Saving Results"
      ],
      "metadata": {
        "id": "NAAqEragnQAR"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "In research, it is critical to stay organized and store your results safely."
      ],
      "metadata": {
        "id": "b4EL9R60nRxC"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "First, we connect Google Drive, so we can store our files there. Otherwise, any generated files get erased after the runtime disconnects.\n",
        "\n",
        "When you run the cell below, it'll prompt you to sign-in."
      ],
      "metadata": {
        "id": "9fiVqenTnykj"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import json\n",
        "import os\n",
        "from google.colab import drive\n",
        "\n",
        "# Mount Google Drive\n",
        "drive.mount('/content/drive')"
      ],
      "metadata": {
        "id": "6SE123VunxtI"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "You can access your google drive with the folder icon on the left (i.e the second to last one)\n",
        "\n",
        "![image.png](data:image/png;base64,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)"
      ],
      "metadata": {
        "id": "29XYsgD4oSIj"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Note: When you save files to your Google drive, it may not immediately update in there. You can repeatedly click the folder icon to have it refresh, and it may take a minute."
      ],
      "metadata": {
        "id": "bE2uAFHiofZZ"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "What's the best way to store your results? There's lots of ways you can do this, and if you're already used to a certain method, feel free to stick to it.\n",
        "\n",
        "One method that I like is saving results in .csv and .json files. csv files are nice since it is easy to save to it incrementally when you run your code, so that if your code disconnects in the middle of a 10 hour run, you can start where you left off with some small code changes rather than re-running from scratch. json is nice since it is convenient to convert to Python dictionaries and vice versa. It's easy to convert a csv to json.\n",
        "\n",
        "One small caveat: CSV files cannot be writen in parallel (without some advanced workarounds). A simpler workaround if you're running experiments in parallel is to write to separate CSV files and then merge them later."
      ],
      "metadata": {
        "id": "-PVBef9rtCp1"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import csv\n",
        "import os\n",
        "import json\n",
        "\n",
        "def save_result_incrementally(result, file_path): # result is a python dictionary containing data that will become clearer in the next section.\n",
        "    # with open(file_path, 'a', newline='') as file:\n",
        "    with open(file_path, 'a', newline='', encoding='utf-8') as file:\n",
        "        writer = csv.writer(file)\n",
        "        writer.writerow([result['question'], result['true_answer'], result['raw_output_answer'], result['extracted_output_answer'], result['numerical_true_answer'], result['numerical_output_answer']])\n",
        "\n",
        "\n",
        "def csv_to_json(csv_file_path, json_file_path):\n",
        "    results = []\n",
        "\n",
        "    with open(csv_file_path, mode='r') as file:\n",
        "        csv_reader = csv.reader(file)\n",
        "\n",
        "        for row in csv_reader:\n",
        "            result = {\n",
        "                \"question\": row[0],\n",
        "                \"true_answer\": row[1],\n",
        "                \"raw_output_answer\": row[2],\n",
        "                \"extracted_output_answer\": row[3],\n",
        "                \"numerical_true_answer\": row[4],\n",
        "                \"numerical_output_answer\": row[5],\n",
        "            }\n",
        "            results.append(result)\n",
        "\n",
        "    with open(json_file_path, 'w') as json_file:\n",
        "        json.dump(results, json_file, indent=4)\n",
        "\n",
        "\n",
        "def load_results_from_json(file_path):\n",
        "    with open(file_path, 'r') as f:\n",
        "        results = json.load(f)\n",
        "    return results\n",
        "\n",
        "\n",
        "base_dir = '/content/drive/My Drive/'\n",
        "model_name = \"phi1.5b\"\n",
        "dataset_name = \"gsm8k\"\n",
        "\n",
        "csv_base_filename = f'sc_clustering_{model_name}_{dataset_name}_RUN5' # Be organized in how you name it, don't just name it \"temp1\" or something like that. Here's a sample name.\n",
        "csv_file_path = os.path.join(base_dir, csv_base_filename + '.csv')\n",
        "\n",
        "json_base_filename = f'sc_clustering_{model_name}_{dataset_name}'\n",
        "json_file_path = os.path.join(base_dir, json_base_filename + '.json')"
      ],
      "metadata": {
        "id": "bjVRdEgjs2FL"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "Some other convenient things you could code up that we haven't provided code for:\n",
        "- Suppose your run dies midway through the dataset (this happens a lot on Colab free). You could write code so that when you run it again, it automatically continues at the next index it left off on.\n",
        "- Suppose you are generating multiple different CSV files that need to be indexed appropriately. You could write code to generate a new CSV file automatically according to the index, so you don't end up overwriting a file accidently and losing data."
      ],
      "metadata": {
        "id": "iovH6Eohxpd-"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "bCmNhhwzUXWo"
      },
      "source": [
        "# Experiments\n",
        "\n",
        "Now, let's put everything together and run multiple questions at once. In practice, you'll be writing an inference loop like this that runs your experiments for an entire dataset at once.\n",
        "\n",
        "In this case, our `inference_loop` is technically a [higher-order function](https://en.wikipedia.org/wiki/Higher-order_function#:~:text=In%20mathematics%20and%20computer%20science,a%20function%20as%20its%20result.) (i.e a function that takes in another function as an input), since it takes in a prompting function and runs it on GSM8K. You should design your own prompting functions and try them out."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Results should be saved in the CSV file in your Google Drive."
      ],
      "metadata": {
        "id": "gYN19WC6wHjC"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "Sc3baJtNoY4v"
      },
      "outputs": [],
      "source": [
        "def inference_loop(prompt_function):\n",
        "    results = []\n",
        "    correct_answers, total_questions = 0, 0\n",
        "    for batch in debug_dataloader: # Change debug_dataloader to test_dataloader when you want to run the entire dataset.\n",
        "        question = batch['question'][0]\n",
        "        true_answer = batch['answer'][0]\n",
        "\n",
        "        prompt = prompt_function(question)\n",
        "        # print(f\"Prompt: {prompt}\")\n",
        "\n",
        "        inputs = tokenizer(prompt, return_tensors=\"pt\")\n",
        "        inputs = inputs.to(\"cuda\")\n",
        "\n",
        "        # Greedy decoding\n",
        "        outputs = model.generate(**inputs, max_new_tokens=200, do_sample=False) # You may need to modify max_new_tokens for your experiments\n",
        "\n",
        "        raw_output_answer = tokenizer.batch_decode(outputs, skip_special_tokens=True)[0]\n",
        "        print(f\"Raw output answer: {raw_output_answer}\")\n",
        "        extracted_output_answer = extract_intended_generation(raw_output_answer)\n",
        "        print(f\"Extracted output answer: {extracted_output_answer}\")\n",
        "\n",
        "        numerical_output_answer = extract_output_numerical_answer(extracted_output_answer)\n",
        "        numerical_true_answer = extract_true_numerical_answer(true_answer)\n",
        "\n",
        "        if numerical_output_answer is not None and numerical_true_answer is not None:\n",
        "            if numerical_output_answer == numerical_true_answer:\n",
        "                correct_answers += 1\n",
        "        total_questions += 1\n",
        "\n",
        "\n",
        "        # Store as much as you can. Better to save too much than too little. Memory constraints typically aren't a concern for saving results.\n",
        "        result = {\n",
        "            \"question\": question,\n",
        "            \"true_answer\": true_answer,\n",
        "            \"raw_output_answer\": raw_output_answer, # Note that it's recommended to also store the raw output answer, in case that you need to change your extraction function later.\n",
        "            \"extracted_output_answer\": extracted_output_answer,\n",
        "            \"numerical_true_answer\": numerical_true_answer,\n",
        "            \"numerical_output_answer\": numerical_output_answer\n",
        "        }\n",
        "        results.append(result)\n",
        "\n",
        "        save_result_incrementally(result, csv_file_path)\n",
        "\n",
        "    accuracy = correct_answers / total_questions if total_questions > 0 else 0\n",
        "    print(f\"Accuracy: {accuracy:.4f}\")\n",
        "\n",
        "    return results\n",
        "\n",
        "\n",
        "cot_results = inference_loop(cot_prompt_function)\n",
        "# non_cot_results = inference_loop(non_cot_prompt_function)\n",
        "\n",
        "# try your own prompt functions here"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "CXw4wCmBsba7"
      },
      "outputs": [],
      "source": [
        "cot_results"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "Vzq6cIwZrAJ5"
      },
      "outputs": [],
      "source": [
        "# non_cot_results"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "W1Dwp7W-aCGa"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "LktFi_dPemkJ"
      },
      "source": [
        "# Analysis"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### After you run evaluations, you'll have to do some analyses to interpret and/or validate the results that you saw. This often involves creating visualizations. These will often go into the results and/or appendices in your paper."
      ],
      "metadata": {
        "id": "bJFe4kMy4aN3"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Loading in your results\n",
        "\n",
        "If you're re-visiting this Colab later or if your runtime died, uncomment the code to load your results from the csv you saved it in rather than rerunning all the above code."
      ],
      "metadata": {
        "id": "cI4iZyhD2TNW"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# If your runtime died / if you're visiting this Colab later, load your results from your CSV file.\n",
        "\n",
        "# import json\n",
        "# import os\n",
        "# import csv\n",
        "# from google.colab import drive\n",
        "\n",
        "# # Mount Google Drive\n",
        "# drive.mount('/content/drive')\n",
        "\n",
        "# def save_result_incrementally(result, file_path): # result is a python dictionary containing data that will become clearer in the next section.\n",
        "#     # with open(file_path, 'a', newline='') as file:\n",
        "#     with open(file_path, 'a', newline='', encoding='utf-8') as file:\n",
        "#         writer = csv.writer(file)\n",
        "#         writer.writerow([result['question'], result['true_answer'], result['raw_output_answer'], result['extracted_output_answer'], result['numerical_true_answer'], result['numerical_output_answer']])\n",
        "\n",
        "\n",
        "# def csv_to_json(csv_file_path, json_file_path):\n",
        "#     results = []\n",
        "\n",
        "#     with open(csv_file_path, mode='r') as file:\n",
        "#         csv_reader = csv.reader(file)\n",
        "\n",
        "#         for row in csv_reader:\n",
        "#             result = {\n",
        "#                 \"question\": row[0],\n",
        "#                 \"true_answer\": row[1],\n",
        "#                 \"raw_output_answer\": row[2],\n",
        "#                 \"extracted_output_answer\": row[3],\n",
        "#                 \"numerical_true_answer\": row[4],\n",
        "#                 \"numerical_output_answer\": row[5],\n",
        "#             }\n",
        "#             results.append(result)\n",
        "\n",
        "#     with open(json_file_path, 'w') as json_file:\n",
        "#         json.dump(results, json_file, indent=4)\n",
        "\n",
        "\n",
        "# def load_results_from_json(file_path):\n",
        "#     with open(file_path, 'r') as f:\n",
        "#         results = json.load(f)\n",
        "#     return results\n",
        "\n",
        "\n",
        "# base_dir = '/content/drive/My Drive/'\n",
        "# model_name = # Whatever you named it as\n",
        "# dataset_name = # Whatever you named it as\n",
        "\n",
        "# csv_base_filename = # Whatever you named it as\n",
        "# csv_file_path = os.path.join(base_dir, csv_base_filename + '.csv')\n",
        "\n",
        "# json_base_filename = # Whatever you named it as\n",
        "# json_file_path = os.path.join(base_dir, json_base_filename + '.json')\n",
        "\n",
        "# csv_to_json(csv_file_path, json_file_path)\n",
        "# load_results_from_json(json_file_path)"
      ],
      "metadata": {
        "id": "kjv0UhO8xIEV"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### Visualizations\n",
        "\n",
        "Say we want to see if our generations with CoT tend to be longer. In that case, let's visualize the distribution of the number of characters generated!\n",
        "\n",
        "In this case, if we're just using a sample of 5 data points, our graph won't be very interesting since there's not enough data. If we had a lot more datapoints, the graph would be more filled out and more informative."
      ],
      "metadata": {
        "id": "v6YS5aOg31kD"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Let's use a library called matplotlib to visualize the results. ChatGPT is wonderful for coding matplotlib. It's really annoying to code otherwise."
      ],
      "metadata": {
        "id": "1TUNjWlpxgoC"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "w5g496ioaCJL"
      },
      "outputs": [],
      "source": [
        "import matplotlib.pyplot as plt\n",
        "\n",
        "def plot_data(data, title, xlabel=\"Number of Characters\", ylabel=\"Frequency\"):\n",
        "    plt.hist(data, bins=20, alpha=0.5, color='g')\n",
        "    plt.title(title)\n",
        "    plt.xlabel(xlabel)\n",
        "    plt.ylabel(ylabel)\n",
        "    plt.show()\n",
        "\n",
        "# Assuming `cot_results` contains the number of characters in the output for each question\n",
        "cot_num_chars = [len(str(x['extracted_output_answer'])) for x in cot_results]\n",
        "\n",
        "plot_data(cot_num_chars, \"Distribution of Number of Characters Generated with CoT\")"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Assuming `cot_results` contains the number of characters in the output for each question\n",
        "noncot_num_chars = [len(str(x['extracted_output_answer'])) for x in non_cot_results] # define this by running the inference loop again without CoT if you haven't done this already.\n",
        "\n",
        "plot_data(noncot_num_chars, \"Distribution of Number of Characters Generated without CoT\")"
      ],
      "metadata": {
        "id": "SLmtzCs94xm1"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "Here's another sample analysis. When we do CoT, when the answer is wrong, are we numerically closer off to the ground truth answer compared to when we don't use CoT?\n",
        "\n",
        "To answer this, let's visualize the distribution of errors, measured by the distance from our answer to the ground truth answer."
      ],
      "metadata": {
        "id": "lIHqbpBo5IQn"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "AiN9d9Upe1uY"
      },
      "outputs": [],
      "source": [
        "import matplotlib.pyplot as plt\n",
        "\n",
        "def plot_errors(results, title='Histogram of Errors', xlabel='Error', ylabel='Frequency'):\n",
        "    # Extract numerical true answers and output answers\n",
        "    numerical_true_answers = [result['numerical_true_answer'] for result in results if result['numerical_true_answer'] is not None]\n",
        "    numerical_output_answers = [result['numerical_output_answer'] for result in results if result['numerical_output_answer'] is not None]\n",
        "\n",
        "    # Calculate the errors\n",
        "    errors = [abs(true - output) for true, output in zip(numerical_true_answers, numerical_output_answers)]\n",
        "\n",
        "    # Create the histogram\n",
        "    plt.hist(errors, bins=20, color='blue', edgecolor='black')\n",
        "    plt.title(title)\n",
        "    plt.xlabel(xlabel)\n",
        "    plt.ylabel(ylabel)\n",
        "\n",
        "    # Show the plot\n",
        "    plt.show()\n",
        "\n",
        "plot_errors(cot_results, title='Histogram of Errors', xlabel='Error', ylabel='Frequency'):"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "plot_errors(non_cot_results, title='Histogram of Errors', xlabel='Error', ylabel='Frequency') # make sure non_cot_results is defined by running it through the inference loop"
      ],
      "metadata": {
        "id": "AHiCmvtt7JQC"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "Try also calculating the mean of the error distance for each and compare and contrast the two."
      ],
      "metadata": {
        "id": "88ZHQLEJ7KR2"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Your code here"
      ],
      "metadata": {
        "id": "Q6FiAQwZ7QYm"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### We recommend you ask other questions about the generated results and try to create some visualizations to answer those questions!"
      ],
      "metadata": {
        "id": "E59zhoTV5YmH"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "OvUiNeRFaCLq"
      },
      "outputs": [],
      "source": [
        "# Optional - Your code here for other analyses"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# Using the GPT API\n",
        "\n",
        "OpenAI allows you to access their GPT models through an API. Here's the documentation: https://platform.openai.com/docs/overview. Can you figure out how to generate text? Feel free to ask questions to us if you get stuck.\n",
        "\n",
        "Note - Unlike most coding tasks, **ChatGPT actually won't be able to help you with this**, since it wasn't trained on updated enough data. It still uses their deprecated v1 API. Try to figure everything out with just their ChatCompletions documentation.\n",
        "\n",
        "The code for other models from an API endpoint (e.g Claude, Gemini) should be somewhat similar. You'll have to look at their documentation pages accordingly."
      ],
      "metadata": {
        "id": "feXNk6UC5cDZ"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "! pip install openai"
      ],
      "metadata": {
        "id": "eH1Fle4HtMpZ"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "#### First you'll have to create an API key here: https://platform.openai.com/api-keys"
      ],
      "metadata": {
        "id": "xd6WHXjr3cjk"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "Use gpt-3.5-turbo, gpt-4-turbo, or gpt-4o. **Never use GPT4** without the turbo, as it's comparable to turbo but significantly more expensive."
      ],
      "metadata": {
        "id": "dXfCILgs-TEc"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "from openai import OpenAI\n",
        "client = OpenAI(api_key = \"YOUR CODE HERE\")\n",
        "\n",
        "completion = client.chat.completions.create(\n",
        "  model=\"gpt-3.5-turbo\",\n",
        "  messages=[\n",
        "    {\"role\": \"system\", \"content\": train_dataset[0][\"question\"]},\n",
        "    {\"role\": \"user\", \"content\": \"Answer the question.\"}\n",
        "  ]\n",
        ")\n",
        "\n",
        "print(completion.choices[0].message.content)"
      ],
      "metadata": {
        "id": "nBWfrJsB5fA1",
        "collapsed": true
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "If you want, you could do all the experiments that we did above but with GPT3.5 rather than Phi1.5B. Just change model.generate to use the API instead.\n",
        "\n",
        "Feel free to play around with other parameters, such as temperature or logprobs. Full documentation here: https://platform.openai.com/docs/api-reference/chat\n",
        "\n",
        "You could also try inputting images rather than text, as the recent GPT models are multimodal."
      ],
      "metadata": {
        "id": "LScV6MdP-o6-"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Optional explorations"
      ],
      "metadata": {
        "id": "Hzp3ce0Z-9c9"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "# Self-Consistency\n",
        "\n",
        "Now, you should try implementing self-consistency - the majority vote version. We will leave this purposefully open-ended, so you can gain confidence in coding ideas from scratch. If you fully understand the code above and conceptually what self-consistency is, this likely won't be too difficult - you'll be able to re-use a very large sample of the code above, with an inference loop, methods to extract the output, etc. One major change in particular though is that you will need to modify the decoding method.\n",
        "Remember that you can and should use ChatGPT to guide you! Get comfortable with providing it with large chunks of code and having extended conversations with it."
      ],
      "metadata": {
        "id": "4EBgDw0_E29J"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Your code here"
      ],
      "metadata": {
        "id": "m1egbgbuE_ax"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "# That's it for this coding skeleton! Congratulations on finishing this, this was a lot :)."
      ],
      "metadata": {
        "id": "3Xvx3qVc_B2F"
      }
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "provenance": [],
      "gpuType": "T4",
      "collapsed_sections": [
        "iJjMSoCxTLd1"
      ],
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    },
    "widgets": {
      "application/vnd.jupyter.widget-state+json": {
        "390f3e1b4ac64c4ab7f1002ff8aae546": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_f1e91c56f1cb4e139f7b701c1b0e4554",
              "IPY_MODEL_918e7530e37340779d14e96e813789ec",
              "IPY_MODEL_aac2ca4181c9416e95a819997e9a87d7"
            ],
            "layout": "IPY_MODEL_e1b888e1e2ba46a7afd4ebdc67a7253e"
          }
        },
        "f1e91c56f1cb4e139f7b701c1b0e4554": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_cfe5fc58171d4ba5b552cb9e4b2b719f",
            "placeholder": "​",
            "style": "IPY_MODEL_247c6ba72700455599e617e49e970879",
            "value": "README.md: 100%"
          }
        },
        "918e7530e37340779d14e96e813789ec": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_99b6582b66b84030af76e91a2c95eda7",
            "max": 7940,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_d5d0199919d64998a50d4b224cd8fb50",
            "value": 7940
          }
        },
        "aac2ca4181c9416e95a819997e9a87d7": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_6938dd8af2ee4c649ca52f6c14df1b75",
            "placeholder": "​",
            "style": "IPY_MODEL_7d1358b3f52c4f5ca28565e4be1790ef",
            "value": " 7.94k/7.94k [00:00&lt;00:00, 168kB/s]"
          }
        },
        "e1b888e1e2ba46a7afd4ebdc67a7253e": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "cfe5fc58171d4ba5b552cb9e4b2b719f": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "247c6ba72700455599e617e49e970879": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "99b6582b66b84030af76e91a2c95eda7": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "d5d0199919d64998a50d4b224cd8fb50": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "6938dd8af2ee4c649ca52f6c14df1b75": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "7d1358b3f52c4f5ca28565e4be1790ef": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "2f7fae69adc64eae84ac0e37f2263cac": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_e49bbdbcb703454590522b37648d8be1",
              "IPY_MODEL_c6091b42cd9f40c783ee6f0102ef5428",
              "IPY_MODEL_28d436bb6f294ae0a636a07b7276a27d"
            ],
            "layout": "IPY_MODEL_f55bbd0385644606a0f503196b84a28e"
          }
        },
        "e49bbdbcb703454590522b37648d8be1": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_7055bc9c1fac422e88c195931bd1a08e",
            "placeholder": "​",
            "style": "IPY_MODEL_29e400910f6d4d6ca83c76526d7ca54d",
            "value": "train-00000-of-00001.parquet: 100%"
          }
        },
        "c6091b42cd9f40c783ee6f0102ef5428": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_c736de1966d6405d9f8644a591712ccd",
            "max": 2306545,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_88854c254940440d96d24618c8d30b71",
            "value": 2306545
          }
        },
        "28d436bb6f294ae0a636a07b7276a27d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_ae060401db7b40b388b7ace9fddb02da",
            "placeholder": "​",
            "style": "IPY_MODEL_53eb28eefae047c486a771079ab3ff74",
            "value": " 2.31M/2.31M [00:00&lt;00:00, 18.2MB/s]"
          }
        },
        "f55bbd0385644606a0f503196b84a28e": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "7055bc9c1fac422e88c195931bd1a08e": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "29e400910f6d4d6ca83c76526d7ca54d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "c736de1966d6405d9f8644a591712ccd": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "88854c254940440d96d24618c8d30b71": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "ae060401db7b40b388b7ace9fddb02da": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "53eb28eefae047c486a771079ab3ff74": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "80128482cc454833980f9a1285ad2ce0": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_b26d1d5a12204b749a7fd85f4f721dfd",
              "IPY_MODEL_34bf18ba47cf4a20bae1bca4098943be",
              "IPY_MODEL_6ffecb1bd34546e5b697c4836943aaf9"
            ],
            "layout": "IPY_MODEL_b862a82209c348c0ba026a3df6befe26"
          }
        },
        "b26d1d5a12204b749a7fd85f4f721dfd": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_aa14cc2094b04df8a93caa0648231a44",
            "placeholder": "​",
            "style": "IPY_MODEL_d7271005f91a49e19c48de1d9d201e9b",
            "value": "test-00000-of-00001.parquet: 100%"
          }
        },
        "34bf18ba47cf4a20bae1bca4098943be": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_56f6981432cc4cf698dae1f7005bdce4",
            "max": 419088,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_0462bfb6efa04595aedf4acd39195dce",
            "value": 419088
          }
        },
        "6ffecb1bd34546e5b697c4836943aaf9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_9a69787f300942388d606ce3bf85f41e",
            "placeholder": "​",
            "style": "IPY_MODEL_c0497b46f47f449393028e6aa7fe160d",
            "value": " 419k/419k [00:00&lt;00:00, 6.02MB/s]"
          }
        },
        "b862a82209c348c0ba026a3df6befe26": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "aa14cc2094b04df8a93caa0648231a44": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "d7271005f91a49e19c48de1d9d201e9b": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "56f6981432cc4cf698dae1f7005bdce4": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "0462bfb6efa04595aedf4acd39195dce": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "9a69787f300942388d606ce3bf85f41e": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "c0497b46f47f449393028e6aa7fe160d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "0e3f83faa62f48acbfac2215aa456816": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_cf2296bc0ed54616b6407094a7c5639c",
              "IPY_MODEL_44b18ef367494e00adb545e45e8474ac",
              "IPY_MODEL_959dfcdac96542819f91f2001940ff83"
            ],
            "layout": "IPY_MODEL_055115bdcf8541f181cd1af98787d272"
          }
        },
        "cf2296bc0ed54616b6407094a7c5639c": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_76b1556ccafe42debcd7d4070adf1328",
            "placeholder": "​",
            "style": "IPY_MODEL_6b406864f7c84d33bcc1527a71906a1a",
            "value": "Generating train split: 100%"
          }
        },
        "44b18ef367494e00adb545e45e8474ac": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_a2a8dff5b3fc4909ad97eb6dcb9efc93",
            "max": 7473,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_3c69ec5f3c4c44938bab05ae740575fd",
            "value": 7473
          }
        },
        "959dfcdac96542819f91f2001940ff83": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_568f24ebf4c04a4989e3f8be66496838",
            "placeholder": "​",
            "style": "IPY_MODEL_750305af96324dbc84c688ee208d83c9",
            "value": " 7473/7473 [00:00&lt;00:00, 69877.17 examples/s]"
          }
        },
        "055115bdcf8541f181cd1af98787d272": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "76b1556ccafe42debcd7d4070adf1328": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "6b406864f7c84d33bcc1527a71906a1a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "a2a8dff5b3fc4909ad97eb6dcb9efc93": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "3c69ec5f3c4c44938bab05ae740575fd": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "568f24ebf4c04a4989e3f8be66496838": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "750305af96324dbc84c688ee208d83c9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "63ab9226d7ce4e7aba1f39d58f6cc861": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_3091c2b99cd9451898f1a8ef2ee19d6a",
              "IPY_MODEL_83af47ff285c46d9bfc37dd2b595ed47",
              "IPY_MODEL_6a796acbc67c40daad79a23f39c88670"
            ],
            "layout": "IPY_MODEL_671d34f188184f3eac4b385d01214a3a"
          }
        },
        "3091c2b99cd9451898f1a8ef2ee19d6a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_02cadd6986124517b9c670db3ad70bd8",
            "placeholder": "​",
            "style": "IPY_MODEL_54b3a839ca7941caa955a42671919b94",
            "value": "Generating test split: 100%"
          }
        },
        "83af47ff285c46d9bfc37dd2b595ed47": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_78281c1e15be448ebb491fc0880b87a9",
            "max": 1319,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_2d4dee2313c249bda9a32e96382168ab",
            "value": 1319
          }
        },
        "6a796acbc67c40daad79a23f39c88670": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_f34944d03fd04a138ce88afd18452d58",
            "placeholder": "​",
            "style": "IPY_MODEL_8c0543e35d4a46f49b948356d0607d16",
            "value": " 1319/1319 [00:00&lt;00:00, 20632.55 examples/s]"
          }
        },
        "671d34f188184f3eac4b385d01214a3a": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "02cadd6986124517b9c670db3ad70bd8": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "54b3a839ca7941caa955a42671919b94": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "78281c1e15be448ebb491fc0880b87a9": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "2d4dee2313c249bda9a32e96382168ab": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "f34944d03fd04a138ce88afd18452d58": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "8c0543e35d4a46f49b948356d0607d16": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "6fe7b8a5ad674d11acd3bf7c720bcd54": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_40e43dc6978340e8aa562f2cc77340de",
              "IPY_MODEL_7b5f1f77c3194921bfad9c679464610a",
              "IPY_MODEL_643146741aae4ec88ddfffbf70a06069"
            ],
            "layout": "IPY_MODEL_c444287ed4e541d69ba588731e653794"
          }
        },
        "40e43dc6978340e8aa562f2cc77340de": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_a3c7c080dbaf4d4d99f0feff29179c0c",
            "placeholder": "​",
            "style": "IPY_MODEL_623daa9ee6794901b97a3a4a31b244a9",
            "value": "Map: 100%"
          }
        },
        "7b5f1f77c3194921bfad9c679464610a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_d7cac953d6234acb8abcb8eb45561e0f",
            "max": 7473,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_5a1134fb3fa444299797c22ee00d2bab",
            "value": 7473
          }
        },
        "643146741aae4ec88ddfffbf70a06069": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_2a62c3460a4c47aabf6aafe00d9a72f0",
            "placeholder": "​",
            "style": "IPY_MODEL_cf7c90a457f84fa9a3180e934beceda4",
            "value": " 7473/7473 [00:00&lt;00:00, 10173.19 examples/s]"
          }
        },
        "c444287ed4e541d69ba588731e653794": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "a3c7c080dbaf4d4d99f0feff29179c0c": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "623daa9ee6794901b97a3a4a31b244a9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "d7cac953d6234acb8abcb8eb45561e0f": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "5a1134fb3fa444299797c22ee00d2bab": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "2a62c3460a4c47aabf6aafe00d9a72f0": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "cf7c90a457f84fa9a3180e934beceda4": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "3bda77ec9ec94a1b97dd8eb25d39600e": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_b982557685424ae78ab7f34a7a6b47c8",
              "IPY_MODEL_1827df2ce95346b1a0c1e8ba9b7fe6a5",
              "IPY_MODEL_2dfb65dad23649eab651d2634621822d"
            ],
            "layout": "IPY_MODEL_2e5144b505594707a9fe0a593bdc58c7"
          }
        },
        "b982557685424ae78ab7f34a7a6b47c8": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_f44976d20a12446a8740ab5d540d2ac3",
            "placeholder": "​",
            "style": "IPY_MODEL_49c56998ed494cc2b75cb4da6f2ab378",
            "value": "Map: 100%"
          }
        },
        "1827df2ce95346b1a0c1e8ba9b7fe6a5": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_3f9ad5154be343d5bbe92219644fd90a",
            "max": 5,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_9bd3ec8bc8c64ea1ac62511fc8ce9dad",
            "value": 5
          }
        },
        "2dfb65dad23649eab651d2634621822d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_8bd733aed0264eb6bdaa0d56cdfeb4c9",
            "placeholder": "​",
            "style": "IPY_MODEL_9895e8ec98524096aac923b8326b1356",
            "value": " 5/5 [00:00&lt;00:00, 88.19 examples/s]"
          }
        },
        "2e5144b505594707a9fe0a593bdc58c7": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "f44976d20a12446a8740ab5d540d2ac3": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "49c56998ed494cc2b75cb4da6f2ab378": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "3f9ad5154be343d5bbe92219644fd90a": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "9bd3ec8bc8c64ea1ac62511fc8ce9dad": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "8bd733aed0264eb6bdaa0d56cdfeb4c9": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "9895e8ec98524096aac923b8326b1356": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "af85b521821e40ea98629b1e557ec20a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_9f0b8329fea8459ca35869e092186d51",
              "IPY_MODEL_b3977c26e2cf47a6a2846f03d93a6b2a",
              "IPY_MODEL_e19c59d7898e4a4487e4ab1916eed372"
            ],
            "layout": "IPY_MODEL_34fd3ee511f04cba9117eda66c203292"
          }
        },
        "9f0b8329fea8459ca35869e092186d51": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_8d4aef19420148bc80b432fba2af425b",
            "placeholder": "​",
            "style": "IPY_MODEL_af3f33e680ca43cba5a9252d3129ca10",
            "value": "Map: 100%"
          }
        },
        "b3977c26e2cf47a6a2846f03d93a6b2a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_ec3fd671152247b19732960e43149106",
            "max": 1319,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_4b23cbb285dc48529052850e212ad60c",
            "value": 1319
          }
        },
        "e19c59d7898e4a4487e4ab1916eed372": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_cac1c02cca3947c1974ea98c1baeba51",
            "placeholder": "​",
            "style": "IPY_MODEL_7757d6ef63194c4ab96d1ca4f8f644d8",
            "value": " 1319/1319 [00:00&lt;00:00, 3396.12 examples/s]"
          }
        },
        "34fd3ee511f04cba9117eda66c203292": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "8d4aef19420148bc80b432fba2af425b": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "af3f33e680ca43cba5a9252d3129ca10": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "ec3fd671152247b19732960e43149106": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "4b23cbb285dc48529052850e212ad60c": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "cac1c02cca3947c1974ea98c1baeba51": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "7757d6ef63194c4ab96d1ca4f8f644d8": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "364bd0f06bda4b74addc4c08bf301d20": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_f83140ce1dd1468ea25636605d813063",
              "IPY_MODEL_7e2624d0e60c471086adfff7e23a8e29",
              "IPY_MODEL_23c84439b65d449e8681e5d00a7a3504"
            ],
            "layout": "IPY_MODEL_f51ff6773e5e40f7a9a974785885938d"
          }
        },
        "f83140ce1dd1468ea25636605d813063": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_03a0776b46e441fe8a98c258bc9966aa",
            "placeholder": "​",
            "style": "IPY_MODEL_b9e1e2f206844db48e0c743721c862b2",
            "value": ""
          }
        },
        "7e2624d0e60c471086adfff7e23a8e29": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_98495e76add04feaa3a46f09b0dbb8ff",
            "max": 1,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_7bff001815f8437785ddd4acc11f8b75",
            "value": 0
          }
        },
        "23c84439b65d449e8681e5d00a7a3504": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_78a073afa98d4a11941b2c20b01e49a4",
            "placeholder": "​",
            "style": "IPY_MODEL_78a48fa552664d21a5fecff00ad2ee9d",
            "value": " 0/0 [00:00&lt;?, ?it/s]"
          }
        },
        "f51ff6773e5e40f7a9a974785885938d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "03a0776b46e441fe8a98c258bc9966aa": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b9e1e2f206844db48e0c743721c862b2": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "98495e76add04feaa3a46f09b0dbb8ff": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": "20px"
          }
        },
        "7bff001815f8437785ddd4acc11f8b75": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "78a073afa98d4a11941b2c20b01e49a4": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "78a48fa552664d21a5fecff00ad2ee9d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "39c4f067b9ed40328b95942be3069e3f": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_e179aca2b3aa46959473e535ce9748e5",
              "IPY_MODEL_2d48cb2813964aa4a3efaefc658cc437",
              "IPY_MODEL_344bb7559f104bfabf70b778561ec16c"
            ],
            "layout": "IPY_MODEL_acd17af546174af381f846279dd52373"
          }
        },
        "e179aca2b3aa46959473e535ce9748e5": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_8189d087aabd4747976cba69bc9db163",
            "placeholder": "​",
            "style": "IPY_MODEL_3ab11073819140ae865d16747bb72ec5",
            "value": "config.json: 100%"
          }
        },
        "2d48cb2813964aa4a3efaefc658cc437": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_554e6305f42343e6bc02d6d5c3ccb955",
            "max": 736,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_ea69cc07f7654a08bbdeb8e862222f0b",
            "value": 736
          }
        },
        "344bb7559f104bfabf70b778561ec16c": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_ebb2c319dba145d68fce044b4ee4d10f",
            "placeholder": "​",
            "style": "IPY_MODEL_1209e8d59c03431b861853979a3f3926",
            "value": " 736/736 [00:00&lt;00:00, 29.1kB/s]"
          }
        },
        "acd17af546174af381f846279dd52373": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "8189d087aabd4747976cba69bc9db163": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "3ab11073819140ae865d16747bb72ec5": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "554e6305f42343e6bc02d6d5c3ccb955": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "ea69cc07f7654a08bbdeb8e862222f0b": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "ebb2c319dba145d68fce044b4ee4d10f": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "1209e8d59c03431b861853979a3f3926": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "b84ee7d9b4c042ffbab58723ca42447b": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_8aba93befc44408f84882ed782f34f68",
              "IPY_MODEL_6be4cd71fa284738976c62afc1f67694",
              "IPY_MODEL_19b33d63ba73475aafec1b3c397ae3a3"
            ],
            "layout": "IPY_MODEL_2066be09ba96465b9d5b4a33ea86cf94"
          }
        },
        "8aba93befc44408f84882ed782f34f68": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_bf783c5568bf4a5b84110a89db327c84",
            "placeholder": "​",
            "style": "IPY_MODEL_814f604387664b6eae3e9cc51f1d8759",
            "value": "model.safetensors:  22%"
          }
        },
        "6be4cd71fa284738976c62afc1f67694": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_0bf0e7d68faf4539886038154f6b6799",
            "max": 2836578696,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_d6e1cf1a545349f5b7c7860f1eefbb04",
            "value": 629145600
          }
        },
        "19b33d63ba73475aafec1b3c397ae3a3": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_28f4af2c798a43a69a4fd29c2f02125f",
            "placeholder": "​",
            "style": "IPY_MODEL_2dc31f2b60144b27ace066a8b2560ef8",
            "value": " 629M/2.84G [00:02&lt;00:09, 243MB/s]"
          }
        },
        "2066be09ba96465b9d5b4a33ea86cf94": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "bf783c5568bf4a5b84110a89db327c84": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "814f604387664b6eae3e9cc51f1d8759": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "0bf0e7d68faf4539886038154f6b6799": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "d6e1cf1a545349f5b7c7860f1eefbb04": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "28f4af2c798a43a69a4fd29c2f02125f": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "2dc31f2b60144b27ace066a8b2560ef8": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        }
      }
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}